const editors = [];

document.querySelectorAll('.code-editor').forEach((textarea, index) => {
  const editor = CodeMirror.fromTextArea(textarea, {
    mode: 'python',
    theme: 'dracula',
    lineNumbers: true,
    matchBrackets: true,
    indentUnit: 4,
    smartIndent: true
  });

  // Dynamic height
  function autoResizeEditor() {
    const lineCount = editor.lineCount();
    const lineHeight = 24;
    const padding = 20;
    const newHeight = Math.min(400, Math.max(100, lineCount * lineHeight + padding));
    editor.getWrapperElement().style.height = newHeight + "px";
    editor.refresh();
  }

  editor.on("change", autoResizeEditor);
  autoResizeEditor();

  editors.push(editor);
});

// Copy functionality for all buttons
document.querySelectorAll('.copy-button').forEach((button, i) => {
  button.addEventListener('click', () => {
    const code = editors[i].getValue();
    navigator.clipboard.writeText(code).then(() => {
      button.textContent = "Copied!";
      setTimeout(() => {
        button.textContent = "Copy Code";
      }, 2000);
    });
  });
});
